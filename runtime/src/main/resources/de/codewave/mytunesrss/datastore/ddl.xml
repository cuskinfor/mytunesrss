<?xml version="1.0" encoding="UTF-8"?>

<statements>

        <statement name="createAllTables">
        <sql>
            {create_table_prefix} track (
                id VARCHAR(100) NOT NULL,
                name VARCHAR(255) NOT NULL,
                lower_name VARCHAR(255) NOT NULL,
                artist VARCHAR(255) NOT NULL,
                original_artist VARCHAR(255) NOT NULL,
                lower_artist VARCHAR(255) NOT NULL,
                album VARCHAR(255) NOT NULL,
                lower_album VARCHAR(255) NOT NULL,
                time INTEGER,
                track_number INTEGER,
                file VARCHAR(1024) NOT NULL,
                suffix VARCHAR(10) NOT NULL,
                protected BOOLEAN,
                mediatype VARCHAR(20),
                source VARCHAR(20),
                genre VARCHAR(255),
                lower_genre VARCHAR(255),
                mp4codec VARCHAR(4),
                ts_played NUMERIC(19),
                ts_updated NUMERIC(19),
                playcount NUMERIC(19),
                last_image_update NUMERIC(19),
                comment VARCHAR(2048),
                lower_comment VARCHAR(2048),
                pos_number INTEGER,
                pos_size INTEGER,
                image_hash CHAR(24),
                year INTEGER,
                UNIQUE (id)
            )
        </sql>
        <sql>
            {create_table_prefix} playlist (
                id VARCHAR(100) NOT NULL,
                name VARCHAR(255) NOT NULL,
                type VARCHAR(20) NOT NULL,
                track_count INTEGER,
                hidden BOOLEAN,
                user_private BOOLEAN,
                user_owner VARCHAR(256),
                ts_create NUMERIC(19),
                container_id VARCHAR(100),
                UNIQUE (id)
            )
        </sql>
        <sql>
            {create_table_prefix} link_track_playlist (
                idx INTEGER,
                track_id VARCHAR(100) NOT NULL,
                playlist_id VARCHAR(100) NOT NULL,
                CONSTRAINT fk_linktrackplaylist_trackid FOREIGN KEY (track_id) REFERENCES track (id) ON DELETE CASCADE,
                CONSTRAINT fk_linktrackplaylist_playlistid FOREIGN KEY (playlist_id) REFERENCES playlist (id) ON DELETE CASCADE
            )
        </sql>
        <sql>
            {create_table_prefix} system_information (
                lastupdate BIGINT,
                version VARCHAR(20) NOT NULL,
                track_count INTEGER,
                album_count INTEGER,
                artist_count INTEGER,
                genre_count INTEGER
            )
        </sql>
        <sql>
            {create_table_prefix} album (
                name VARCHAR(255) NOT NULL,
                lower_name VARCHAR(255) NOT NULL,
                first_char VARCHAR(1),
                track_count INTEGER,
                artist_count INTEGER,
                artist VARCHAR(255),
                image_hash CHAR(24),
                year INTEGER
            )
        </sql>
        <sql>
            {create_table_prefix} artist (
                name VARCHAR(255) NOT NULL,
                lower_name VARCHAR(255) NOT NULL,
                first_char VARCHAR(1),
                track_count INTEGER,
                album_count INTEGER
            )
        </sql>
        <sql>
            {create_table_prefix} genre (
                name VARCHAR(255) NOT NULL,
                lower_name VARCHAR(255) NOT NULL,
                first_char VARCHAR(1),
                track_count INTEGER,
                album_count INTEGER,
                artist_count INTEGER
            )
        </sql>
        <sql>
            {create_table_prefix} image (
                hash CHAR(24) NOT NULL,
                size INTEGER NOT NULL,
                data {image_datatype} NOT NULL,
                UNIQUE (hash, size)
            )
        </sql>
        <sql>
            {create_table_prefix} statistics (
                ts_create NUMERIC(19) NOT NULL,
                data {statistics_datatype} NOT NULL
            )
        </sql>
        <sql>
            {create_table_prefix} smart_info (
                playlist_id VARCHAR(100) NOT NULL,
                album_pattern VARCHAR(100),
                artist_pattern VARCHAR(100),
                genre_pattern VARCHAR(100),
                title_pattern VARCHAR(100),
                file_pattern VARCHAR(100),
                time_min INTEGER,
                time_max INTEGER,
                mediatype VARCHAR(20),
                protected BOOLEAN,
                UNIQUE (playlist_id),
                CONSTRAINT fk_smart_info_playlist_id FOREIGN KEY (playlist_id) REFERENCES playlist (id) ON DELETE CASCADE
            )
        </sql>
        <sql>
            {create_table_prefix} tag (
                track_id VARCHAR(100) NOT NULL,
                tag VARCHAR(50) NOT NULL,
                CONSTRAINT fk_tag_track_id FOREIGN KEY (track_id) REFERENCES track (id) ON DELETE CASCADE
            )
        </sql>
        <sql>CREATE INDEX idx_track_name ON track (name)</sql>
        <sql>CREATE INDEX idx_track_lower_name ON track (lower_name)</sql>
        <sql>CREATE INDEX idx_track_artist ON track (artist)</sql>
        <sql>CREATE INDEX idx_track_lower_artist ON track (lower_artist)</sql>
        <sql>CREATE INDEX idx_track_album ON track (album)</sql>
        <sql>CREATE INDEX idx_track_lower_album ON track (lower_album)</sql>
        <sql>CREATE INDEX idx_track_genre ON track (genre)</sql>
        <sql>CREATE INDEX idx_track_lower_genre ON track (lower_genre)</sql>
        <sql>CREATE INDEX idx_track_comment ON track (comment)</sql>
        <sql>CREATE INDEX idx_track_lower_comment ON track (lower_comment)</sql>
        <sql>CREATE INDEX idx_track_id ON track (id)</sql>
        <sql>CREATE INDEX idx_track_imagehash ON track (image_hash)</sql>
        <sql>CREATE INDEX idx_link_track_playlist_playlist_id ON link_track_playlist (playlist_id)</sql>
        <sql>CREATE INDEX idx_link_track_playlist_index ON link_track_playlist (idx)</sql>
        <sql>CREATE INDEX idx_link_track_playlist_track_id ON link_track_playlist (track_id)</sql>
        <sql>CREATE INDEX idx_album_name ON album (name)</sql>
        <sql>CREATE INDEX idx_album_lower_name ON album (lower_name)</sql>
        <sql>CREATE INDEX idx_album_first ON album (first_char)</sql>
        <sql>CREATE INDEX idx_album_artist ON album (artist)</sql>
        <sql>CREATE INDEX idx_album_year ON album (year)</sql>
        <sql>CREATE INDEX idx_artist_name ON artist (name)</sql>
        <sql>CREATE INDEX idx_artist_lower_name ON artist (lower_name)</sql>
        <sql>CREATE INDEX idx_artist_first ON artist (first_char)</sql>
        <sql>CREATE INDEX idx_genre_name ON genre (name)</sql>
        <sql>CREATE INDEX idx_genre_lower_name ON genre (lower_name)</sql>
        <sql>CREATE INDEX idx_genre_first ON genre (first_char)</sql>
        <sql>CREATE INDEX idx_playlist_id ON playlist (id)</sql>
        <sql>CREATE INDEX idx_statistics_creation ON statistics (ts_create)</sql>
        <sql>CREATE INDEX idx_image_hash ON image (hash)</sql>
        <sql>CREATE INDEX idx_tag_track_id ON tag (track_id)</sql>
        <sql>CREATE INDEX idx_tag_tag ON tag (tag)</sql>
        <sql>{create_playlist_id_sequence}</sql>
    </statement>

    <statement name="dropAllTables">
        <sql>DROP TABLE tag</sql>
        <sql>DROP TABLE statistics</sql>
        <sql>DROP TABLE smart_info</sql>
        <sql>DROP TABLE link_track_playlist</sql>
        <sql>DROP TABLE playlist</sql>
        <sql>DROP TABLE album</sql>
        <sql>DROP TABLE artist</sql>
        <sql>DROP TABLE genre</sql>
        <sql>DROP TABLE track</sql>
        <sql>DROP TABLE system_information</sql>
        <sql>{drop_playlist_id_sequence}</sql>
        <sql>DROP TABLE image</sql>
    </statement>

    <statement name="dropAllTablesForPre30Migration">
        <sql>DROP TABLE link_track_playlist</sql>
        <sql>DROP TABLE playlist</sql>
        <sql>DROP TABLE album</sql>
        <sql>DROP TABLE artist</sql>
        <sql>DROP TABLE genre</sql>
        <sql>DROP TABLE track</sql>
        <sql>DROP TABLE system_information</sql>
        <sql>{drop_playlist_id_sequence}</sql>
        <sql>DROP TABLE pager</sql>
    </statement>

</statements>